<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Callback Test</title>
    </head>
    <body>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/p5.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/addons/p5.dom.js"></script>
        <script src="/js/libraries/p5.speech/p5.speech.js"></script>
        <script>
            var myVoice = new p5.Speech('Google UK English Male', speechLoaded); // new P5.Speech object

            //myVoice.onLoad = speechLoaded; // could do it this way
            myVoice.onStart = speechStarted;
            myVoice.onEnd = speechEnded;

            var lyric = "now is the winter of our discontent.  made glorious summer by this sun of york.  and all the clouds that loured upon our house.  in the deep bosom of the ocean buried.";

            var speakbutton; // UI

            function setup()
            {
                createCanvas(400, 400);

                // button:
                speakbutton = createButton('Speak');
                speakbutton.position(180, 200);
                speakbutton.mousePressed(buttonClicked);
            }

            function draw()
            {
                // why draw when you can click?
            }

            function buttonClicked()
            {
                console.log("clicked");
                if(speakbutton.elt.innerHTML=='Speak') myVoice.speak(lyric);
                else if(speakbutton.elt.innerHTML=='Pause') myVoice.pause(); // not working
                else if(speakbutton.elt.innerHTML=='Resume') myVoice.resume(); // not working
                else if(speakbutton.elt.innerHTML=='Stop') myVoice.stop();
            }

            function speechLoaded()
            {
                console.log("loaded");
                // say cheers:
                myVoice.speak("testing one two three!!!");
            }

            function speechStarted()
            {
                background(0, 255, 0);
                speakbutton.elt.innerHTML = 'Stop';
            }

            function speechEnded()
            {
                console.log("end");
                background(255, 0, 0);
                speakbutton.elt.innerHTML = 'Speak';
            }

        </script>
    </body>
</html>
